pipeline {
    agent any
    stages {
        stage('Build image')
        {
          steps{
            script{
              def dockerHome = tool 'docker'
              env.PATH = "${dockerHome}/bin:${env.PATH}"
              sh 'docker build --build-arg CLIENT_ID=79ccc48a450cd4e391a8 -t takenote:mytag .'
              withCredentials([usernamePassword(credentialsId: 'DockerHubAccount', usernameVariable: 'USERNAME',\
              passwordVariable: 'PASSWORD')]) {
              sh "docker login -u ${USERNAME} -p ${PASSWORD}"
              sh "docker tag takenote:mytag mmaaasshhaaaaa/takenote:latest"
              sh "docker push mmaaasshhaaaaa/takenote:latest"
              echo "Image push complete"
             }
          }
        }
    }
  }
}
